<!DOCTYPE html>
<head>
    <meta charset="utf-8">
    <title>Home</title>
    <link rel="stylesheet" href="./home.css">
    <!-- 一旦保留 <script src="./home.js"></script> -->
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="https://wataru532.github.io/Scheduler/artworks/apple-touch-icon-180x180.png">
</head>
<body>
    <section class="headsection">
        <img class="home-img1" src="artworks/apple-touch-icon-180x180.png">
        <p1>Scheduler - Home</p1>
        <div align="right">
            <a href="./login.html" class="login_button">Account</a>
        </div>
        
    
        <div align="left">
            <a href="./home.html" class="home">Home</a>
            <a href="./assignments.html" class="assignments">Assignments</a>
            <a href="./classes.html" class="classes">Classes</a>
            <a href="./notifications.html" class="notifications">Notifications</a>
            <a href="https://mail.google.com/chat/u/0/#chat/home" class="chats" target="_blank" rel="noopener noreferrer">Chats</a>
        </div>
        <hr class="line1">
    </section>
    <p2>Class : <span id="classroomname"></span></p2><br>
    <p3>Today : <span id="text"></span></p3><br>
    <table align="center" border=1>
        <thead>
            <tr>
                <th>  </th>
                <th><span id="monday">Mon</span></th>
                <th><span id="tueday">Tue</span></th>
                <th><span id="wedday">Wed</span></th>
                <th><span id="thuday">Thu</span></th>
                <th><span id="friday">Fri</span></th>
            </tr>
            <tr>
                <th><span id="month_now"></span></th><th><span id="d_Mon"></span></th><th><span id="d_Tue"></span></th>
                <th><span id="d_Wed"></span></th><th><span id="d_Thu"></span></th><th><span id="d_Fri"></span></th>
            </tr>
        </thead>
        <tbody>
            <!-- 将来的に<a>タグでリンク飛べるようにする -->
            <tr><td>1</td><td><span id="0"></span></td><td><span id="6"></span></td><td><span id="12"></span></td><td><span id="18"></span></td><td><span id="24"></span></td></tr>
            <tr><td>2</td><td><span id="1"></span></td><td><span id="7"></span></td><td><span id="13"></span></td><td><span id="19"></span></td><td><span id="25"></span></td></tr>
            <tr><td>3</td><td><span id="2"></span></td><td><span id="8"></span></td><td><span id="14"></span></td><td><span id="20"></span></td><td><span id="26"></span></td></tr>
            <tr><td>4</td><td><span id="3"></span></td><td><span id="9"></span></td><td><span id="15"></span></td><td><span id="21"></span></td><td><span id="27"></span></td></tr>
            <tr><td>5</td><td><span id="4"></span></td><td><span id="10"></span></td><td><span id="16"></span></td><td><span id="22"></span></td><td><span id="28"></span></td></tr>
            <tr><td>6</td><td><span id="5"></span></td><td><span id="11"></span></td><td><span id="17"></span></td><td><span id="23"></span></td><td><span id="29"></span></td></tr>
        </tbody>
    </table><br>
    <a href="https://forms.gle/9ExuRPUDyRMcMxxp8" class="border_btn02" target="_blank" rel="noopener noreferrer">Feedback</a>

    
    <script>
        //使用するグローバル変数の定義
        const now = new Date();
        const year = now.getYear();
        const month = now.getMonth();
        const date = now.getDate();
        const day = now.getDay();
        const months = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
        const weeks = ["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];
        var a = 0;
        var b = 0;
        const subj = {
            "芸": ["音楽","美術","書道"],
            "日地": ["日本史","地理"],
            "物生": ["物理","生物"],
            "理物生": ["物理","生物"],
            "地歴β": ["地理β","歴史β"],
            "世政経": ["世界史","政治","経済"]

        }
        const classroom_name = [
                            "3-1","3-2","3-3","3-4","3年理探","3年国探",
                            "2-1","2-2","2-3","2-4","2年理探","2年国探",
                            "1-1","1-2","1-3","1-4","1-5","1-6"
                        ]
        
        //うるう年の処理
        if (year%4==0 && !(year%100==0 && year%400!=0)) {
            var dates = [31,29,31,30,31,30,31,31,30,31,30,31];
        } else{
            var dates = [31,28,31,30,31,30,31,31,30,31,30,31];
        }

        document.getElementById("text").innerHTML = showDay();
        document.getElementById("d_Mon").innerHTML = showd_Mon();
        document.getElementById("d_Tue").innerHTML = showd_Tue();
        document.getElementById("d_Wed").innerHTML = showd_Wed();
        document.getElementById("d_Thu").innerHTML = showd_Thu();
        document.getElementById("d_Fri").innerHTML = showd_Fri();
        document.getElementById("month_now").innerHTML = month_Now();
  
        function showDay() {
            return weeks[day] + " " + months[month] + "/" + date + " " + now.getFullYear();
        }

        //以下日付処理
        function showd_Mon(){
            document.getElementById("d_Mon").className = "not_today";
            if (date-day+1 > dates[month]){
                a = date-day+1 - dates[month];
            } else if (date-day+1 <= 0){
                a = dates[month-1] + date-day+1;
            }else{
                a = date - day + 1;
            }
            
            return a;
        }

        function showd_Tue(){
            document.getElementById("d_Tue").className = "not_today";
            if (date-day+2 > dates[month]){
                return date-day+2-dates[month];
            }else if (date-day+2 <= 0){
                return dates[month-1] + date-day+2;
            } else{
                return date - day + 2;
            }
        }

        function showd_Wed(){
            document.getElementById("d_Wed").className = "not_today";
            if (date-day+3 > dates[month]){
                return date-day+3-dates[month];
            }else if (date-day+3 <= 0){
                return dates[month-1] + date-day+3;
            } else{
                return date - day + 3;
            }
        }

        function showd_Thu(){
            document.getElementById("d_Thu").className = "not_today";
            if (date-day+4 > dates[month]){
                return date-day+4-dates[month];
            }else if (date-day+4 <= 0){
                return dates[month-1] + date-day+4;
            } else{
                return date - day + 4;
            }
        }

        function showd_Fri(){
            document.getElementById("d_Fri").className = "not_today";
            if (date-day+5 > dates[month]){
                b = date-day+5-dates[month];
            } else if (date-day+5 <= 0){
                b =  dates[month-1] + date-day+5;
            }else{
                b =  date - day + 5;
            }
            return b;
        }

        function month_Now(){
            if(date < 10 && a > b){
                var c = months[month-1];
                var d = months[month];
            }
            else if(date > 10 && a > b){
                var c = months[month];
                var d = months[month+1];
            }
            else{
                var c = months[month];
                var d = "none";
            }

            if (d == "none"){
                return c;
            }else{
                return c + " / " + d;
            }
        }

        //強調構文
        function emphasize(){
            document.getElementById("monday").className = "not_today";
            document.getElementById("tueday").className = "not_today";
            document.getElementById("wedday").className = "not_today";
            document.getElementById("thuday").className = "not_today";
            document.getElementById("friday").className = "not_today";
            
            if(day == 1){
                document.getElementById("monday").className = "today";
                document.getElementById("d_Mon").className = "today";
                
            } else if (day == 2){
                document.getElementById("tueday").className = "today";
                document.getElementById("d_Tue").className = "today";

            } else if (day == 3){
                document.getElementById("wedday").className = "today";
                document.getElementById("d_Wed").className = "today";
                
            } else if (day == 4){
                document.getElementById("thuday").className = "today";
                document.getElementById("d_Thu").className = "today";
                
            } else if (day == 5){
                document.getElementById("friday").className = "today";
                document.getElementById("d_Fri").className = "today";
            }
        }

        function view_data(){ //データの表示
            var jsonData;
            var classData;
            var selectionData;
            //選択科目のデータを取得するプログラムを記述
            //以下は仮のデータ
            selectionData = {
                "class":"12", //12 as 2年理探
                "subjects":{" 芸":"音楽", " 理物生":"物理", " 日地":"地理"}
            }

            document.getElementById("classroomname").innerHTML = classroom_name[selectionData["class"]-2];

            //json data
            fetch('https://Wataru532.github.io/Scheduler/data/schedule_data.json')
            .then(function(response) {
              if (!response.ok) {
                throw new Error('Failed to load JSON file: ' + response.statusText);
              }
              return response.json();
            })
            .then(function(data) {
              jsonData = data;
              console.log(jsonData);
              classData = jsonData[selectionData["class"]]["null"]; 
              console.log(classData);

              for (let i = 0; i < 30; i++){
                if (classData[i] == " 芸" || classData[i] == " 物生" || classData[i] == " 理物生" || classData[i] == " 日地" || classData[i] == " 地歴β" || classData[i] == " 世政経"){
                    classData[i] = selectionData["subjects"][classData[i]];
                }
              }

              //set data
              for (let i = 0; i < 30; i++){
                document.getElementById(String(i)).innerHTML = classData[i];
              }
            })
            .catch(function(error) {
              console.error('Error fetching JSON file: ', error);
            });
        }
        
        showDay();
        showd_Mon();
        showd_Tue();
        showd_Wed();
        showd_Thu();
        showd_Fri();
        month_Now();
        emphasize();
        view_data();
        
    </script>
</body>